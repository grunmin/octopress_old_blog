<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tag: linux | 郭润民的博客]]></title>
  <link href="http://grunmin.github.io/tags/linux/atom.xml" rel="self"/>
  <link href="http://grunmin.github.io/"/>
  <updated>2014-04-30T14:37:26+08:00</updated>
  <id>http://grunmin.github.io/</id>
  <author>
    <name><![CDATA[Grunmin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Openshift 安装使用教程]]></title>
    <link href="http://grunmin.github.io/blog/2014/03/16/openshift-an-zhuang-shi-yong-jiao-cheng/"/>
    <updated>2014-03-16T21:09:00+08:00</updated>
    <id>http://grunmin.github.io/blog/2014/03/16/openshift-an-zhuang-shi-yong-jiao-cheng</id>
    <content type="html"><![CDATA[<p>声明：配置环境是fedora 20，这里是<a href="https://access.redhat.com/site/documentation/en-US/OpenShift_Online/2.0/html/User_Guide/index.html">官方文档</a>，找文档是解决问题最有效的方式。</p>

<!-- more -->


<h3>介绍</h3>

<blockquote><p>OpenShift是红帽公司推出的一个云计算服务平台，开发人员可以用它来构建和发布web应用。Openshift广泛支持多种编程语言和框架，如Java，Ruby和PHP等。另外它还提供了多种集成开发工具如Eclipse integration，JBoss Developer Studio和 Jenkins等。OpenShift 基于一个开源生态系统为移动应用，数据库服务等，提供支持。
——来自百度百科</p></blockquote>

<p>简言之，就是一个面向开源开发人员开放的平台即服务(PaaS)。</p>

<p>使用openshift首先需要一个账户，注册十分简单，不在此赘述。
配置自己的openshift可以通过几种方式，比如web端，命令行。web端适合刚刚接触的新手，建议新用户多点点链接，熟悉一下大体的使用方法和功能。当准备好创建应用时即往下看。本文是介绍命令行下的配置，毕竟修改代码什么的都需要在本地修改后再提交。而openshift的客户端就是基于命令行的。</p>

<h3>安装</h3>

<h5>安装命令行客户端</h5>

<p><code>
sudo yum install rubygem-rhc -y
</code></p>

<h5>初始化设置</h5>

<p><code>
sudo rhc setup
</code>
此时需要输入帐号和密码，即为自己在openshift注册时的帐号。</p>

<p>令人费解的是使用我的本地账户运行<code>rhc</code>显示找不到命令，切换为root运行也是如此。只能使用<code>sudo rhc</code>的方式，后面运行<code>git push</code>也是如此，必须是<code>sudo git push</code>。如果你知道原因，烦请不吝赐教。</p>

<h5>使用gem更新rhc</h5>

<p><code>
sudo gem update rhc
</code>
然后看看自己的账户
<code>
sudo rhc account
</code>
在安装rhc的时候本地用户已和云端绑定，ssh公钥也导入了，因此之后的操作一般不需要再作验证。</p>

<h5>查看自己的app</h5>

<p><code>
sudo rhc apps
</code>
可以看到自己账户下有多少个app（免费账户最多3个），应用名，git仓库地址，主机地址，绑定的域名，以及模块，数据库版本，数据库用户和密码等等。比如我的wordpress（数据库账户和密码被我屏蔽）。
```</p>

<h2>blog @ <a href="http://blog-grunmin.rhcloud.com/">http://blog-grunmin.rhcloud.com/</a> (uuid: 5325520fe0b8cd3a830009ff)</h2>

<p>  Domain:          grunmin
  Created:         3:26 PM
  Gears:           1 (defaults to small)
  Git URL:         ssh://5325520fe0b8cd3a830009ff@blog-grunmin.rhcloud.com/~/git/blog.git/
  Initial Git URL: <a href="https://github.com/openshift/wordpress-example.git">https://github.com/openshift/wordpress-example.git</a>
  SSH:             5325520<a href="&#109;&#97;&#105;&#x6c;&#x74;&#x6f;&#x3a;&#x66;&#x65;&#x30;&#98;&#x38;&#99;&#x64;&#x33;&#x61;&#56;&#51;&#x30;&#x30;&#x30;&#x39;&#x66;&#x66;&#x40;&#98;&#x6c;&#111;&#x67;&#x2d;&#103;&#114;&#x75;&#x6e;&#x6d;&#105;&#110;&#46;&#114;&#x68;&#99;&#108;&#x6f;&#117;&#x64;&#46;&#x63;&#x6f;&#109;">&#x66;&#101;&#x30;&#98;&#x38;&#x63;&#x64;&#x33;&#97;&#56;&#x33;&#x30;&#48;&#x30;&#57;&#x66;&#102;&#x40;&#x62;&#108;&#x6f;&#x67;&#45;&#x67;&#114;&#117;&#110;&#109;&#105;&#x6e;&#x2e;&#x72;&#x68;&#99;&#x6c;&#111;&#x75;&#x64;&#x2e;&#x63;&#x6f;&#109;</a>
  Deployment:      auto (on git push)
  Aliases:         wp.guorunmin.cn</p>

<p>  mysql-5.1 (MySQL 5.1)</p>

<hr />

<pre><code>Gears:          Located with php-5.3
Connection URL: mysql://$OPENSHIFT_MYSQL_DB_HOST:$OPENSHIFT_MYSQL_DB_PORT/
Database Name:  blog
Password:       ********
Username:       ******
</code></pre>

<p>  php-5.3 (PHP 5.3)</p>

<hr />

<pre><code>Gears: Located with mysql-5.1
</code></pre>

<p>```</p>

<h3>创建应用</h3>

<h5>创建</h5>

<p>看别人的东西干过瘾，不如自己创建一个，创建的方法也很简单，只需一个命令
<code>
sudo rhc app create AppName
</code>
Openshift 支持Java，Ruby，Node.js，PHP，Perl和Python，在AppName 后面可以加其他参数，例如php应用是：
<code>
sudo rhc app create AppName php-5.4
</code>
有一种是diy模式，即自行搭建语言环境的，面对一台陌生的机器，我没有任何信心能完成这样的工作^_^。刚开始的时候，我找不到CI框架的环境（有ZF），所以选择新建空应用，以为我自己的代码可以在服务器上运行，想想还是比较天真哈哈哈
如果是安装环境了，改代码的之前需要将仓库克隆到本地。如果新建空应用，那么rhc会自动将仓库克隆下来。</p>

<p>更多参数可以参见<a href="https://access.redhat.com/site/documentation/en-US/OpenShift_Online/2.0/html/User_Guide/Creating_an_Application5.html">官方文档</a>，不用担心看不懂英文，我翻了一遍，文档大体都能看懂。</p>

<h5>添加mysql和phpmyadmin模块</h5>

<p>既然是php应用，mysql和phpmyadmin怎么能少呢！让我们添加一下
<code>
sudo rhc cartridge add mysql-5.1 -a AppName
sudo rhc cartridge add phpmyadmin -a AppName
</code>
此时新建的应用信息大概就是你看到的上面那个。建议保存一下有用的信息，比如phpmyadmin的地址，用户名和密码，尤其是使用web端创建的同学*_*</p>

<p><em>安装wordpress后还需登陆网站添加安装配置信息</em></p>

<p>如果要删除应用，执行
<code>
sudo rhc app delete AppName
</code></p>

<h3>开始码字</h3>

<p>如果安装的是wordpress这些成熟的应用，因为它提供了管理界面，大概不用去修改代码。如果是自己开发的应用呢？Openshift支持git的方式修改云端上的代码。大体流程应该是这样：
克隆代码到本地->进入应用目录->进入代码目录->修改代码->git add,commit,push->服务器上的应用关闭->一系列编译布置->应用重启->完成</p>

<p>克隆操作
<code>
sudo rhc git-clone AppName
</code>
或者知道仓库地址，像这样
<code>
sudo git clone ssh://53257e56e0b8cd671500019b@app-grunmin.rhcloud.com/~/git/app.git/
</code>
php应用根目录下默认有两个文件夹，.git和.openshift。（安装wordpress时候还有另外三个目录：libs,misc,php，但是我找不到wordpress的代码）.openshift目录的作用官网的说明挺详细，我只知道是存放git动作触发的脚本文件，没有深入研究。根目录下还有index.php文件，就是登陆AppName-AccountName.rhcloud.com时看到的页面。这样的设计应该很明朗了，我们直接将代码放在应用根目录下即可。或许你可以写个测试文件看看php的环境，比如"welcome.php"
```
&lt;?php</p>

<pre><code>     phpinfo();
</code></pre>

<p>?>
```</p>

<p>另外我们可以ssh进去主机看看里面的文件。如果想了解的话还是自己找找资料吧，比如<a href="http://www.dashashi.com/index.php/2013/01/1435">openshift用ssh登陆后的目录结构</a>。</p>

<h3>访问</h3>

<p>虽说是否被墙是判断一个服务好坏的标准，不过眼看着这么好的服务被墙还是挺让人窝火。因此我也希望我们能够好好利用openshift，不要见缝插针，浪费资源。</p>

<p>如果是博客，那么有一个自己的域名当然比较好。如果不是的话，为了避免被墙，建议也绑定一个，虽然不一定能起作用。绑定域名，也是一个命令搞定：
<code>
sudo rhc alias add AppName YourDomain
</code>
当然，你需要在域名提供商那里添加一个CNAME记录，指向你的openshift域名。
<em>因为缓存的原因，域名解析不会立刻生效。</em></p>

<p>或者使用https的方式访问。</p>

<p>其他跨栏的姿势很多，不赘述。</p>

<p>参考：
<a href="http://www.live-in.org/archives/1818.html">openshift使用方法介绍</a></p>

<p><a href="http://www.live-in.org/archives/1818.html">openshift用ssh登陆后的目录结构</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[android 下用脚本备份文件到dropbox的实现]]></title>
    <link href="http://grunmin.github.io/blog/2014/03/15/android-xia-yong-jiao-ben-bei-fen-wen-jian-dao-dropboxde-shi-xian/"/>
    <updated>2014-03-15T23:28:00+08:00</updated>
    <id>http://grunmin.github.io/blog/2014/03/15/android-xia-yong-jiao-ben-bei-fen-wen-jian-dao-dropboxde-shi-xian</id>
    <content type="html"><![CDATA[<p>前些日子寻找linux下上传文件到云的脚本，以实现远程服务器上资料的云端备份。</p>

<!-- more -->


<p>国内的网盘虽说正逐渐在开放API，但是到实现方便个人云存储应该还需一定的时间，百度云的pcs接口也关闭了（现在重新开放）。这方面国外的Dropbox做得不错，已经有一些相对成熟的应用。比如脚本<a href="https://github.com/andreafabrizi/Dropbox-Uploader">Dropbox-Uploader</a>。</p>

<blockquote><p>Dropbox Uploader is a BASH script which can be used to upload, download, delete, list files (and more!) from Dropbox, an online file sharing, synchronization and backup service.</p>

<p>It&rsquo;s written in BASH scripting language and only needs cURL.</p></blockquote>

<p>Dropbox Uploader 是一个bash脚本，提供上传，下载，移动网盘上的文件等功能。通过学习已经实现了远程服务器上的云端备份（2G空间已塞满……准备转投百度云）。</p>

<p>既然是bash脚本，那么怀着linux心的android系统应该也可以使用。虽然现在各种云app充斥眼球，但是相对而言它们都太庞大了。比如百度云app，安装后大小有20+M。我只需要一个能提供上传下载的app，而不是一个集社交，防盗为一体，还总是要后台运行的臃肿app。因此开始着手如何将Dropbox Uploader用在手机上。</p>

<p>我们知道，android下的shell是不完整的，默认是ash。因此我主要做的工作是弄出一个bash的环境，没有什么技术含量，纯粹是一时兴起。</p>

<p>那就开始吧。</p>

<p>1、手机提权</p>

<p>就是root了，关于root的教程网上都有。没有取得root权限，后面的操作都无法执行。对我来说，自己的手机不root就不像是自己的手机。</p>

<p>2、安装busybox，终端模拟器</p>

<p>可以在谷歌市场下载<a href="https://play.google.com/store/apps/details?id=stericson.busybox&amp;hl=zh_CN">busybox</a>和<a href="https://play.google.com/store/apps/details?id=jackpal.androidterm&amp;hl=zh_CN">终端模拟器</a>。busybox提供了bash下的一系列常用的命令。比系统自带的强。安装需要root权限，正常安装即可。终端模拟器用来输入命令，也可用<a href="https://play.google.com/store/apps/details?id=os.tools.scriptmanager">脚本管理器</a>。</p>

<p>3、下载bash，curl，dropbox_uploader.sh</p>

<p>下载<a href="http://pan.baidu.com/s/1i3mhTyd">bash</a>，<a href="http://pan.baidu.com/s/1lGkZ8">curl</a>，到/system/bin/目录下。在终端模拟器下输入<code>bash</code>应该能进入bash。dropbox_uploader.sh即为Dropbox Uploader的文件名，也放在/system/bin/目录下。</p>

<p>4、其他准备</p>

<p>首先修改Dropbox Uploader文件的第一行，将其sh改为/system/bin/bash，然后新建一个文件夹/tmp,<code>mkdir /tmp</code>。</p>

<p>5、创建dropbox应用</p>

<p>使用Dropbox Uploader前需要在Dropbox上创建应用，让该应用具有文件修改权限。具体如何实现可参考<a href="http://teddysun.com/178.html">Dropbox Uploader的使用教程</a>
Dropbox Uploader的数据传输是加密的，前面的那些设置并没有包含这些。(当时没有找到方法，现在也没有去折腾。因此在使用Dropbox Uploader时需加 <code>-k</code>参数，不检查ssl证书。)</p>

<p>6、使用</p>

<p>按照上面的方法设置后，应该就可以用Dropbox Uploader上传文件了。因为在手机上敲打命令不易，因此我们可以另外写个脚本，比如：
```</p>

<h1>!/system/bin/bash</h1>

<p>/system/bin/dropbox_uploader.sh -k -s upload $1
```
将脚本命名为u，打开终端模拟器，键入u filename即可将文件上传到dropbox。下载也是一样。</p>

<p><strong>后记</strong></p>

<p>这是我寒假在家没有电脑的消遣之举，现在看来这东西实在非常鸡肋，但是当时弄了一个晚上。终于弄成功时那种喜悦难以言表，因此打算回校写篇教程。本文言尽于此，后续不再完善存在的问题。因为我已经找到了完美的替代品，<a href="https://play.google.com/store/apps/details?id=com.damiapp.softdatacable&amp;hl=zh_CN">软件数据线</a>。</p>

<p>参考引用：
<a href="http://teddysun.com/178.html">备份利器Dropbox Uploader</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[fedora 下调节外放音量和屏幕亮度]]></title>
    <link href="http://grunmin.github.io/blog/2014/03/13/fedora-xia-diao-jie-wai-fang-yin-liang-he-ping-mu-liang-du/"/>
    <updated>2014-03-13T00:43:00+08:00</updated>
    <id>http://grunmin.github.io/blog/2014/03/13/fedora-xia-diao-jie-wai-fang-yin-liang-he-ping-mu-liang-du</id>
    <content type="html"><![CDATA[<h3>声音</h3>

<p>fedora系统下笔记本外放功能可能有受到一些限制。接耳机的时候声音是正常的，但是拔下耳机后电脑并不能外放声音。网上搜到的方法是：</p>

<!-- more -->


<p>终端运行alsamixer->按F6键，选中对应硬件，应该会出现这样的画面<img src="https://lh4.googleusercontent.com/-Pj4Qb92Mz3M/UyCOC4GBLFI/AAAAAAAAAJ0/IZSLgP3Xxqs/w614-h346-no/2014-03-13-002941_614x346_scrot.png" alt="" />，调高第三条的音量即可实现外放。</p>

<h3>显示</h3>

<p>1、可用命令行<code>xgamma -gamma X</code>暂时调节笔记本的屏幕亮度,X的值在1以下。</p>

<p>2、如果用英特尔集成显卡，则<code>/sys/class/backlight/intel_backlight/brightness</code>是调节屏幕亮度的，文件中的数字即代表亮度。
用vim编辑器改是不可以的，因此用重定向的方法：
```</p>

<h1>echo 100 > /sys/class/backlight/intel_backlight/brightness</h1>

<p>```
数值大概在100到200之间（我的默认是187,后改为100）。</p>

<p>如果用NVIDIA显卡，则存在<code>/sys/class/backlight/acpi_video0/brightness</code>这个文件，更改方法如上。</p>

<p>这两个方法都不能永久性地更改亮度。不过我们可以通过脚本的方式，让计算机启动的时候执行这些命令，以达到开机即调整亮度的需求。</p>

<p>在/etc/rc.d/init.d/目录下，新建一脚本，比如命名为brightness，写入以下内容
```</p>

<h1>add for chkconfig</h1>

<h1>chkconfig:2345 70 30</h1>

<h1>description:modify brightness</h1>

<h1>processname:brightness</h1>

<p>xgamma -gamma 0.7
echo 50 > /sys/class/backlight/intel_backlight/brightness
echo 50 > /sys/class/backlight/acpi_video0/brightness
```
其中2345表示脚本在哪一运行级别生效，70和30表示开机/关机时启动/关闭的顺序，数字越大越靠后。processname即为服务的名称，作标识用。</p>

<p>给脚本可执行权限
<code>
chmod +x brightness
</code>
将脚本添加入服务控制列表
<code>
chkconfig --add brightness
</code>
此时用<code>chkconfig --list</code>可查看brightness服务在2345运行级别里是默认开启的。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[apache服务器个人主页的设置]]></title>
    <link href="http://grunmin.github.io/blog/2014/01/02/apachefu-wu-qi-ge-ren-zhu-ye-de-she-zhi/"/>
    <updated>2014-01-02T16:16:00+08:00</updated>
    <id>http://grunmin.github.io/blog/2014/01/02/apachefu-wu-qi-ge-ren-zhu-ye-de-she-zhi</id>
    <content type="html"><![CDATA[<ul>
<li>查看apache版本
<code>
httpd -v
</code>
我的版本是2.4.6，个人主页相关的配置文件在<br/>
<code>/etc/httpd/conf.modules.d/00-base.conf</code><br/>
和
<code>etc/httpd/conf.d/userdir.conf</code></li>
</ul>


<!--more-->


<ul>
<li><p>查看<code>/etc/httpd/conf.modules.d/00-base.conf</code>，必须有<code>userdir_module</code>模块，如：
<code>
$ cat /etc/httpd/conf.modules.d/00-base.conf | grep userdir
LoadModule userdir_module modules/mod_userdir.so
</code></p></li>
<li><p>进入<code>/etc/httpd/conf.d/userdir.conf</code>设置，将第17行的<code>UserDir disabled</code>加上注释并取消24行<code>UserDir public</code>的注释(可以更改UserDir后面文件夹的名字，比如<code>UserDir www</code>)</p></li>
<li><p>进入个人家目录，创建一个文件夹www和测试页面
<code>
mkdir ~/www
cd ~/www
echo "Test home dir" &gt;&gt; index.html
</code></p></li>
<li>重启服务器，用浏览器打开<code>http://localhost/~username</code>，应该会出现403页面。
<code>
client denied by server configuration
</code></li>
</ul>


<p>将selinux关闭，查看是否可以访问。</p>

<ul>
<li>如果不能访问，添加下面的代码到<code>/etc/httpd/conf/httpd.conf</code>文件中</li>
</ul>


<p>```
 #将name和username按情况替换掉
<Directory "/home/username/www"></p>

<pre><code>AllowOverride None
Options Indexes FollowSymLinks
Require all granted
</code></pre>

<p></Directory>
```</p>

<p>这里要注意的是，apache2.4版本已经取消了
```</p>

<pre><code>Order Deny,Allow
Allow from All
</code></pre>

<p><code>
的使用，而采用
</code></p>

<pre><code>Require all granted
</code></pre>

<p>```
来设置对目录的访问。</p>

<ul>
<li>设置别名
<code>
Alias /name/ "/home/usename/www/"
</code>
到此个人目录可以使用，将代码放到~/www目录下吧^_^。</li>
</ul>


<blockquote><p>如果服务器总是显示403的话，检查以下你的家目录是否具有执行权限，修改为755即可。</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[octopress博客搭建和个性化配置]]></title>
    <link href="http://grunmin.github.io/blog/2013/11/04/octopressda-jian-he-ge-xing-hua-pei-zhi/"/>
    <updated>2013-11-04T15:02:00+08:00</updated>
    <id>http://grunmin.github.io/blog/2013/11/04/octopressda-jian-he-ge-xing-hua-pei-zhi</id>
    <content type="html"><![CDATA[<p>使用octopress搭建博客的人，大概都会喜欢写关于如何搭建配置octopress的文章。因为它的高定制性，为极客们带来很多乐趣。从首页的配置，到分类，评论，个人信息，社会化分享等的配置，内容繁多。而且这是我第二次搭建octopress环境了，发现上一次的配置有一部分不能clone到本机上。因此，把配置的过程记录下来是十分有必要的。<br/>
我的意愿是记录配置的过程，顺便整理大牛们关于这方面的一些说明。网络上相关资料有很多，没有实践过的没有摘录在这里。所有的代码实现都是直接引用前辈们的。另外，本博的配置环境是linux fedora 18.</p>

<!-- more -->


<h4><a href="http://octopress.org/">octopress官方网站</a></h4>

<p>octopress的配置都可以在官网上找到。事实上，遇到问题查询官网文档是最有效率的方法。</p>

<h3>github的设置</h3>

<h4>创建仓库</h4>

<p>登陆github网站，注册一个用户，假设为grunmin。<br/>
创建一个仓库，命名为username.github.com，例如<code>grunmin.github.com</code></p>

<h4>使用密钥登陆github</h4>

<p><code>
[[ -f ~/.ssh/id_rsa.pub ]] || ssh-keygen -t rsa     #生成密钥对
</code>
按默认一直确认即可。<br/>
在github帐号设置里找到ssh的设置，添加一个ssh key。<br/>
进入~/.ssh/找到id_rsa.pub文件，把里面的内容填到key里，title不填。<br/>
这样做的好处是之后push到仓库上时可以不用输入密码。</p>

<h3>安装ruby</h3>

<p>查看ruby版本<br/>
<code>
ruby --version  # 必须显示1.9.3
</code>
安装方法：
<code>
curl -L https://get.rvm.io | bash -s stable --ruby
rvm install 1.9.3
rvm use 1.9.3
rvm rubygems latest
</code>
若有显示命名未找到，直接下载安装即可。</p>

<h3>安装octopress</h3>

<p>在安装octopress之前，确保已安装git。
<code>
git clone git://github.com/imathis/octopress.git octopress
cd octopress
gem install bundler
bundle install
rake install
</code>
这里容易出现三个问题：<br/>
1、已安装rvm和bundler，但显示找不到命令。</p>

<p>用绝对路径：<code>/home/username/.rvm/bin/rvm</code>
<code>/home/username/.rvm/bin/bundler</code><br/>
2、执行bundler install时显示：GemfileNotFound error?</p>

<p>可能在安装的过程中退出了octopress目录，进入后执行即可。<br/>
3、执行rake install时显示<br/>
<code>
rake aborted!
No Rakefile found (looking for: rakefile, Rakefile, rakefile.rb, Rakefile.rb)
</code>
同理，进入安装目录即可。</p>

<h3>将博客部署到github上</h3>

<p><code>
rake setup_github_pages
</code>
此时会要求输入仓库的url，可以在github仓库内容业的右下角找到。<br/>
例如我的是<code>git@github.com:grunmin/grunmin.github.com.git</code><br/>
成功后即可用
<code>
rake new_post["title"]
</code>
生成新文章，文章在source/_post/目录下，文件名构成为时间和标题的拼音。之后执行<br/>
<code>
rake generate
rake preview   
</code>
此时可以预览(浏览器打开localhost:4000可看到效果。）如果没有问题，则执行
<code>
rake deploy
git add .
git comment -m "comment"
git push origin source
</code>
保存到仓库。<br/>
需要注意的是执行git命令时应处于octopress目录，并且checkout到source分支，
<code>
cd octopress
git checkout source
git add .
git commit -m "comment"
git push origin souce
</code></p>

<h3>octopress博客的个性化配置</h3>

<h4>添加文章分类（category)</h4>

<p>1、增加category_list插件<br/>
将下面的代码写到<code>plugins/category_list_tag.rb</code>
```
module Jekyll
  class CategoryListTag &lt; Liquid::Tag</p>

<pre><code>def render(context)
  html = ""
  categories = context.registers[:site].categories.keys
  categories.sort.each do |category|
    posts_in_category = context.registers[:site].categories[category].size
    category_dir = context.registers[:site].config['category_dir']
    category_url = File.join(category_dir, category.gsub(/_|\P{Word}/, '-').gsub(/-{2,}/, '-').downcase)
    html &lt;&lt; "&lt;li class='category'&gt;&lt;a href='http://grunmin.github.io/#{category_url}/'&gt;#{category} (#{posts_in_category})&lt;/a&gt;&lt;/li&gt;\n"
  end
  html
end
</code></pre>

<p>  end
end</p>

<p>Liquid::Template.register_tag(&lsquo;category_list&rsquo;, Jekyll::CategoryListTag)
```</p>

<p>2、增加侧边栏<br/>
将下面的代码写到<code>source/_includes/asides/category_list.html</code>
```
<section>
  <h1>Categories</h1>
  <ul id="categories"></p>

<pre><code>{% category_list %} 
</code></pre>

<p>  </ul>
</section>
```</p>

<p>修改_config.yml文件，找到<code>default_asides:</code><br/>
在中括号内添加
<code>asides/category_list.html</code></p>

<p>添加的位置决定在页面显示的位置，注意用逗号隔开。<br/>
用vim编辑器粘贴的话可能会自动缩进，启用粘贴模式或用其他编辑器即可。</p>

<h4>添加社会化评论</h4>

<p>octopress 产生静态网页，不支持评论功能，所以我们用第三方评论系统。好消息是octopress已为我们配置好了Disqus，我们只需要稍微填写以下信息即可。<br/>
1、首先在<a href="http://www.disqus.com/">Disqus</a> 注册一个帐号，点击添加到我的网页，添加站点信息，比如我的<code>grunmin.github.io</code><br/>
2、修改_config.yml文件，找到这一段：
```</p>

<h1>Disqus Comments</h1>

<p>disqus_short_name:
disqus_show_comment_count: false
```
添加你的disqus用户名，并把false修改成true即可。注意冒号后面有空格。<br/>
此外，可以用国内的多说系统，速度较快，且比较符合景德镇村民的需要。之前我用的就是这个，但是没有记录配置过程，这次克隆时多说系统没有成功启动，因此不折腾了，有需要的话可以自行谷歌。</p>

<h4>导航栏设置</h4>

<p>导航栏的设置在<code>source\_includes\custom\navigation.html</code><br/>
我们可以将Blog和Archives修改为首页和归档，也可以在此添加一个标签页，此时应使用命令<code>rake new_page['about']</code>创建一个页面，页面路径为<code>source\about\index.markdown</code>;<br/>
修改后的文件如下：
```</p>

<ul class="main-navigation"> 
  <li><a href="/">首页</a></li> 
  <li><a href="/blog/archives">归档</a></li> 
  <li><a href="/about">关于</a></li> 
</ul>


<p>```</p>

<h3>从新电脑上恢复博客内容：</h3>

<p>如果电脑重装了系统，或者要在另一台电脑编写博客，可以这样设置。
找到博客仓库的url，执行
<code>
git clone -b source (url) octopress   #把source 克隆到本地octopress目录上
</code>
<code>
cd octopress
git clone (url) _deploy   #克隆master分支，它存放着博客内容。
</code>
<code>
gem install bundler
bundle install
rake install
rake setup_github_pages
</code>
之后操作同上，有问题照葫芦画瓢。</p>

<h3>其他问题</h3>

<p>如果不能生成或者推送博客了，可以采取下述措施：</p>

<ul>
<li>在命令行输入<code>/bin/bash --login</code>，重试</li>
<li>查看ruby的版本，如果不是1.9.3的话，执行<code>rvm use 1.9.3</code></li>
</ul>


<p><strong>持续更新…………</strong></p>

<h4>参考文章：</h4>

<p><a href="http://beyondvincent.com/blog/2013/08/03/108-creating-a-github-blog-using-octopress/">利用Octopress搭建一个Github博客</a></p>

<p><a href="http://www.yangzhiping.com/tech/octopress.html">Ruby开源项目介绍(1)：octopress——像黑客一样写博客</a></p>

<p><a href="http://codemacro.com/2012/07/18/add-category-list-to-octopress/">为octopress添加分类(category)列表</a></p>

<p><a href="http://www.cnblogs.com/oec2003/archive/2013/05/31/3109577.html">冯威的学习专栏&mdash;-记录工作学习点滴</a></p>
]]></content>
  </entry>
  
</feed>
